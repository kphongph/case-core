<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymer-filters/polymer-filters.html">
<link rel="import" href="../bower_components/polymer-cookie/polymer-cookie.html">
<link rel="import" href="../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="ltc-people.html">
<link rel="import" href="ltc-forms.html">
<link rel="import" href="ltc-person.html">
<link rel="import" href="ltc-token.html">

<polymer-element name="ltc-app" vertical layout>

<template>

  <link rel="stylesheet" href="ltc-app.css">
  
  <polymer-cookie name="access_token" value="{{value}}">
  </polymer-cookie>

  <ltc-token cookie="{{value}}"></ltc-token>

  <core-animated-pages selected="{{selected}}" 
    transitions="cross-fade-all"
    flex auto>
    <div name="splash">
      <a href="/auth/google">
      <img src="/images/White-signin_Medium_base_32dp.png">
      </img>
      </a>
    </div>
    <ltc-people name="people" selectedPerson="{{person_id}}">
    </ltc-people>
    <ltc-person name="person" docid="{{person_id}}" 
        person="{{person}}">
    </ltc-person>
    <ltc-forms name="form" person="{{person}}"></ltc-forms>
  </core-animated-pages>

</template>

<script>
Polymer('ltc-app', {
  // testing
  selected:'person',
  person_id:'54fda8bf7b080506038dfab9',
  eventDelegates: {
    'main':'showSearchPerson',
    'form':'showForm',
    'person':'showPerson',
    'core-complete':'monitorAjax'
  },
  monitorAjax: function(e, o) {
    console.log('monitorAjax');
    /*
    if(o.response == 401) {
      console.log('Unauthorized');
      this.selected = 'splash';
    }
    */
  },
  showPerson: function() {
    this.selected = 'person';
  },
  showForm: function() {
    this.selected = 'form';
    console.log(this.person);
  },
  showSearchPerson: function() {
    this.selected = 'people';
  },
  personChanged: function(oldVal,newVal) {
    this.selected = 'person';
  },
  reset : function() {
    console.log('reset');
  }

});
</script>
</polymer-element>
