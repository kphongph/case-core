<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
    <script src="bower_components/webcomponentsjs/webcomponents.min.js"></script>
    <link rel="import" href="bower_components/font-roboto/roboto.html">
    <link rel="import" href="bower_components/core-scaffold/core-scaffold.html">
    <link rel="import" href="bower_components/core-animated-pages/core-animated-pages.html">
    <link rel="import" href="bower_components/core-toolbar/core-toolbar.html">
    <link rel="import" href="bower_components/core-icons/core-icons.html">
    <link rel="import" href="bower_components/paper-icon-button/paper-icon-button.html">
    <link rel="import" href="bower_components/flatiron-director/flatiron-director.html">
    <link rel="import" href="elements/person-list.html">
    <link rel="import" href="elements/person-detail.html">
    <link rel="import" href="elements/case-questionnaire.html">
    <link rel="stylesheet" href="css/app.css">
  </head>

  <body unresolved vertical layout>
   <template id="t" is="auto-binding">
    <flatiron-director id='page-director' route="{{route}}" 
        autoHash on-director-route="{{routeChanged}}">
    </flatiron-director>

    <core-toolbar>
      <core-icon-button icon="{{$.pages.selected != 'person/list' ? 'arrow-back' : 'menu'}}" on-tap="{{back}}"></core-icon-button>
      <div flex>Case Manager</div>
    </core-toolbar>
   
    <core-animated-pages id="pages" selected="{{route}}" 
      valueattr="page"
      transitions="cross-fade-all hero-transition"
      flex>
      <section page="questionnaire">
        <div fit hero-p>
          <person-list on-person-select="{{personSelected}}">
        </person-list>
      </section>
      <section page="person/list">
        <case-questionnaire></case-questionnaire>
      </section>
      <section page="person/detail">
        <div fit hero-p>
        <person-detail docid="{{personId}}"></person-detail> 
        </div>
      </section>
    </core-animated-pages>
   </template>

   <script>
     var template = document.querySelector('#t');

     template.addEventListener('template-bound', function() {
       this.route = this.route || "person/list"; // default route to "1".
     });

     template.personSelected = function(event, doc) {
       this.route = "person/detail";
       console.log(doc.id);
       this.personId = doc.id;
     };

     template.back = function() {
       this.$.pages.selected = "person/list";
     };
   </script>
  </body>
</html>
